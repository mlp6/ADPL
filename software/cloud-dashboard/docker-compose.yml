version: '2'
services: 
  server:
    build: 
      context: node-server
      args: 
        - DB_URI="mongodb://db/adpl"
    environment:
      - PORT="4000"
      - DB_URI="mongodb://db/adpl"
    ports:
        - 80:4000
    command: ["./wait-for-it.sh", "db:27017", "--", "node", "server.js"]
  db:
    image: mongo:latest
    ports:
        - 27017:27017
    volumes:
      - $DB_DATA:/data/db 
    environment:
      - MONGODB_USER="fake_user_for_github"
      - MONGODB_PASS="fake_pass_for_github"
    command: mongod

